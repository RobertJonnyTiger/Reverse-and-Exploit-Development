# Reverse-and-Exploit-Development
ELF 32-bit Reversing<br />
**The logic example behind program in python**:<br />
    1. try Create socket else "`could not create socket`".<br />
    2. Call to `htons()` - Host to Network short.<br />
    3. try Bind  print "bind done" else "`bind failed`" to a port -> exit<br />
    4. listen for connection in while true - repeat itself "`waiting for incoming connections`"<br />
    5. try accept connections; print "`connection accepted`" except error - print "`accept failed`" -> exit<br />
    6. `recv(1)` 1 byte and store in memory.<br />
    7. `if msg[0] == '\n': begin login process.`<br />
        `elif msg[0] == '\x0f': Send 'You are close'`<br />
        `else: Send 'Meh'`<br />
    8. **login process:**<br />
        I.  Calls `get_string` 3 times: heap allocates memory. `strcpy` the usernames to different heap allocated memory areas.<br />
                + Prints the decimal value of the each username's prefix number with +0x01 to it's value.<br />
        II. Prints the vars it received from the msg (Need a NULL byte).<br />
        III.`strcmp` the usernames 3 times with 3 pre-defined usernames from the program in this order: `'root', 'root', 'toor'`<br />
        IV. `malloc` is called with 0x40 as an argument.<br />
        V.  `memcpy` `"check\x00"` to the the address malloc returned with size of 0x6, the size of "check" + NULL byte.<br />
        VI. OR return value of `strcmp` with '0x00'. saving result to EAX.<br />
        VII.Prints `Success iteration X: %x` ; %x = The result from OR (0 means success in `strcmp`. Otherwise, `strcmp` failed.<br />
        VIII.Frees all 4 allocated memory in the heap in reverse order.  ; `'check'` `'toor'`, `'root'`, and lastly the first `'root'` in msg.<br />
        IX. CMP [EBP+return_value_of_strcmp], 0<br />
                -> if `cmp` is successful: Sets byte to AL<br />
        X.  AL moves to EAX<br />
        XI. return from `login` to `main`.<br />
    9.  EAX moves to stack-0x44 (it can be either 0x00 or 0x01)<br />
    10. cmp stack-0x44 with 0:<br />
        if stack-0x44 == 0: Jumps to sending 'failed' message reply.<br />
        if stack-0x44 != 0: jumps to sending 'successful' message reply.<br />

**Conclusion**:<br />
    A program that demonstrates an authentication process.<br />
    A client will send a msg that will contain:<br />
        a character `(msg[0])`<br />
        kind of like an authentication token (represented as `msg[0]`)<br />
        3 usernames with a prefix number before each one.<br />
    Between each usernames there should be a padding of 43 chars. Each username should end with NULL byte or else program will break and wont allow access.